# Redis в проекте

## 1. Кэширование данных

### Кэширование цен товаров
- **Реализация:** `repositories/products.py`
- **Механизм:**
  - При запросе списка товаров текущие цены сначала ищутся в Redis.
  - Если цена отсутствует в кэше, выполняется запрос к PostgreSQL.
  - Ключи кэша имют формат: `price:{barcode}`.
  - Время жизни кэша: **86400 секунд** (24 часа).

**Преимущества:**
- Снижение нагрузки на PostgreSQL.
- Быстрый отклик при повторных запросах.
- Повышение скрости отображения товаров.

## 2. Управление сессиями и аутентификацией, хранение сессионных данных

### Хранение JWT токенов
- **Реализация:** `services/auth.py`
- **Формат ключей:** `token:{jwt_token}`
- **TTL:** Значение `REDIS_TOKEN_TTL` (по умолчанию 90 секунд)

**Функциональность:**
- Мгновенная проверга валидности токенов.
- Возможность завершать сессии вручную.
- Автоматическое удаление просроченых токенов.

### Проверка активности сессий
- **Реализация:** `pages/login.py`, функция `check_role`
- **Поведение:**
  - При каждом действии обноляется TTL токена.
  - Сессия завершается после 90 секунд бездействия(поставил для наглядности).

### Храние сессионных данных
- Реализовано хранение роли пользователя для предоставления определённого функционала
- Для определения возможности предоставления определённых действий определяется роль пользователя 

## 3. Система уведомлений

### Pub/Sub механизм заказов
- **Публикация:** `services/sales.py` (канал `new_orders`)
- **Подписка:** `main.py`

**Особенности:**
- Уведомления в реальном времени без опроса БД.
- Возможность масштабирования за счёт добавления подписчиков.
- Последдние 5 уведомлений сохраняются в `st.session_state.notifications`.


## Конфигурация Redis

Настройки подключения хранятся в `settings.py`:

```python
REDIS_CONFIG = {
    "host": os.getenv("REDIS_HOST"),  
    "port": os.getenv("REDIS_PORT"),  
}

REDIS_TOKEN_TTL = 90  
